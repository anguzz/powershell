$paths = @(
    "HKLM:\Software\Microsoft\Cryptography\Wintrust\Config",
    "HKLM:\Software\Wow6432Node\Microsoft\Cryptography\Wintrust\Config"
)

$compliant = $true

foreach ($path in $paths) {
    try {
        $value = Get-ItemPropertyValue -Path $path -Name "EnableCertPaddingCheck" -ErrorAction Stop
        if ($value -ne 1) {
            $compliant = $false
        }
    } catch {
        $compliant = $false
    }
}

if ($compliant) {
    Write-Output "Compliant: EnableCertPaddingCheck is set to 1 in both registry paths."
    Write-Output "`nNo action required."
    exit 0
} else {
    Write-Output "Non-Compliant: Missing or incorrect registry value."
    Write-Output "`nPlease run the install script to set the registry value and patch."
    exit 1
}
