$filePath = ""#add the target libcurl dll file here 
$targetVersion = "" #add the target version here

function Compare-Version ($version1, $version2) {
    $version1 = $version1 -replace '-', '.'

    $v1 = [Version]$version1
    $v2 = [Version]$version2
    return $v1.CompareTo($v2)
}

if (Test-Path -Path $filePath) {
    $fileVersion = (Get-Item -Path $filePath).VersionInfo.FileVersion
    Write-Output "Detected file version installed on computer: $fileVersion"

    if ((Compare-Version $fileVersion $targetVersion) -ge 0) {
        Write-Output "Detected version $fileVersion matches requirement"
        exit 0 
    } else {
        Write-Output "Version $fileVersion is lower than the required target version: $targetVersion"
        exit 1  
    }
} else {
    Write-Output "File not found: $filePath"
    exit 1 
}
