# Hotfix for CVE-2025-0167: `libcurl.dll` Vulnerability

This Intune Win32 app package remediates **CVE-2025-0167**, a vulnerability in `libcurl.dll` that may leak credentials during HTTP redirects when a specially crafted `.netrc` file is used. The fix replaces the vulnerable DLL used by the your target application's updater with a secure version from the official curl project (v8.13.0 or newer).


>  **Important**: Replacing `libcurl.dll` can break functionality if the application expects a specific SSL backend or compile-time configuration. Validate the fix in a test environment before broad deployment.


1. **Set TLS** to ensure compatibility with HTTPS downloads.
2. **Detects system architecture** (`x86`, `x64`, `ARM64`) by reading PE headers.
3. **Downloads** the appropriate precompiled `curl` zip from `curl.se`.
4. **Stops any running processes** using the target DLL (if found).
5. **Backs up** the original DLL to a configurable location.
6. **Extracts** and renames the new `libcurl.dll` to match the original's filename and replaces it in place.

##  Package Contents

- `patch.ps1`  
  Replaces the vulnerable `libcurl.dll` with version 8.13.0 based on system architecture. Automatically backs up the original DLL and stops dependent processes before replacement.

- `restore.ps1`  
  Restores the original `libcurl.dll` from backup if issues are detected after patching.

- `detection.ps1`  
  Detects whether a compliant DLL (version 8.13.0 or newer) is present. Used for Intune detection logic for deployment.

## Deployment via Intune

1. Use the **Microsoft Win32 Content Prep Tool** (`IntuneWinAppUtil.exe`) to package:
   - `patch.ps1`
   - `restore.ps1`
   - `detection.ps1`

2. Configure the Intune App with:
   - **Install Command**:  
     ```powershell
     powershell.exe -ExecutionPolicy Bypass -File .\patch.ps1
     ```
   - **Uninstall Command**:  
     ```powershell
     powershell.exe -ExecutionPolicy Bypass -File .\restore.ps1
     ```
   - **Detection Rule**:  
     Script-based detection using `detection.ps1`

---


# References
- [CVE-2025-067 - NVD Listing ](https://nvd.nist.gov/vuln/detail/CVE-2025-0167)
- [libcurl changelog](https://curl.se/changes.html)
- [Official Windows curl builds](https://curl.se/windows/)


## Warning

> libcurl can be compiled with various backends (e.g., OpenSSL, Schannel). Ensure that the replacement `libcurl.dll` is compatible with how the original application was compiled. Replacing with an incompatible binary may break HTTPS functionality or crash the application.

## Example usage 
- Here is an example of the usage to patch the **Notepad++** `libcurl.dll` file. This ideally would be deployed via intune with `System` privileges and run silently on the endpoint. 

### `patch.ps1`
![image](https://github.com/user-attachments/assets/7684eb65-98de-4bee-86ac-c01f4f58ccd6)

### `restore.ps1`
![image](https://github.com/user-attachments/assets/1f37d86f-28d2-4fd7-bdb2-cba45e8785ef)




  
